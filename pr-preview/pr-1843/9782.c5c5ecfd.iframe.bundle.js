"use strict";(self.webpackChunklayerswap=self.webpackChunklayerswap||[]).push([[9782],{"./lib/wallets/solana/transactionBuilder.ts"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>solana_transactionBuilder});var AccountType,index_browser_esm=__webpack_require__("./node_modules/@solana/web3.js/lib/index.browser.esm.js"),mint=__webpack_require__("./node_modules/@solana/spl-token/lib/esm/state/mint.js"),Layout=__webpack_require__("./node_modules/@solana/buffer-layout/lib/Layout.js"),esm=__webpack_require__("./node_modules/@solana/buffer-layout-utils/lib/esm/index.mjs"),constants=__webpack_require__("./node_modules/@solana/spl-token/lib/esm/constants.js"),errors=__webpack_require__("./node_modules/@solana/spl-token/lib/esm/errors.js");!function(AccountType){AccountType[AccountType.Uninitialized=0]="Uninitialized",AccountType[AccountType.Mint=1]="Mint",AccountType[AccountType.Account=2]="Account"}(AccountType||(AccountType={}));const MultisigLayout=(0,Layout.w3)([(0,Layout.u8)("m"),(0,Layout.u8)("n"),(0,esm.lc)("isInitialized"),(0,esm.jE)("signer1"),(0,esm.jE)("signer2"),(0,esm.jE)("signer3"),(0,esm.jE)("signer4"),(0,esm.jE)("signer5"),(0,esm.jE)("signer6"),(0,esm.jE)("signer7"),(0,esm.jE)("signer8"),(0,esm.jE)("signer9"),(0,esm.jE)("signer10"),(0,esm.jE)("signer11")]),MULTISIG_SIZE=MultisigLayout.span;var AccountState,Buffer=__webpack_require__("./node_modules/buffer/index.js").Buffer;!function(AccountState){AccountState[AccountState.Uninitialized=0]="Uninitialized",AccountState[AccountState.Initialized=1]="Initialized",AccountState[AccountState.Frozen=2]="Frozen"}(AccountState||(AccountState={}));const AccountLayout=(0,Layout.w3)([(0,esm.jE)("mint"),(0,esm.jE)("owner"),(0,esm._l)("amount"),(0,Layout.DH)("delegateOption"),(0,esm.jE)("delegate"),(0,Layout.u8)("state"),(0,Layout.DH)("isNativeOption"),(0,esm._l)("isNative"),(0,esm._l)("delegatedAmount"),(0,Layout.DH)("closeAuthorityOption"),(0,esm.jE)("closeAuthority")]),ACCOUNT_SIZE=AccountLayout.span;function unpackAccount(address,info,programId=constants.x5){if(!info)throw new errors.kD;if(!info.owner.equals(programId))throw new errors.bY;if(info.data.length<ACCOUNT_SIZE)throw new errors.vd;const rawAccount=AccountLayout.decode(info.data.slice(0,ACCOUNT_SIZE));let tlvData=Buffer.alloc(0);if(info.data.length>ACCOUNT_SIZE){if(info.data.length===MULTISIG_SIZE)throw new errors.vd;if(info.data[ACCOUNT_SIZE]!=AccountType.Account)throw new errors.ce;tlvData=info.data.slice(ACCOUNT_SIZE+1)}return{address,mint:rawAccount.mint,owner:rawAccount.owner,amount:rawAccount.amount,delegate:rawAccount.delegateOption?rawAccount.delegate:null,delegatedAmount:rawAccount.delegatedAmount,isInitialized:rawAccount.state!==AccountState.Uninitialized,isFrozen:rawAccount.state===AccountState.Frozen,isNative:!!rawAccount.isNativeOption,rentExemptReserve:rawAccount.isNativeOption?rawAccount.isNative:null,closeAuthority:rawAccount.closeAuthorityOption?rawAccount.closeAuthority:null,tlvData}}var types_TokenInstruction,associatedTokenAccount_Buffer=__webpack_require__("./node_modules/buffer/index.js").Buffer;function buildAssociatedTokenAccountInstruction(payer,associatedToken,owner,mint,instructionData,programId=constants.x5,associatedTokenProgramId=constants.EK){const keys=[{pubkey:payer,isSigner:!0,isWritable:!0},{pubkey:associatedToken,isSigner:!1,isWritable:!0},{pubkey:owner,isSigner:!1,isWritable:!1},{pubkey:mint,isSigner:!1,isWritable:!1},{pubkey:index_browser_esm.yq.programId,isSigner:!1,isWritable:!1},{pubkey:programId,isSigner:!1,isWritable:!1}];return new index_browser_esm.fH({keys,programId:associatedTokenProgramId,data:instructionData})}!function(TokenInstruction){TokenInstruction[TokenInstruction.InitializeMint=0]="InitializeMint",TokenInstruction[TokenInstruction.InitializeAccount=1]="InitializeAccount",TokenInstruction[TokenInstruction.InitializeMultisig=2]="InitializeMultisig",TokenInstruction[TokenInstruction.Transfer=3]="Transfer",TokenInstruction[TokenInstruction.Approve=4]="Approve",TokenInstruction[TokenInstruction.Revoke=5]="Revoke",TokenInstruction[TokenInstruction.SetAuthority=6]="SetAuthority",TokenInstruction[TokenInstruction.MintTo=7]="MintTo",TokenInstruction[TokenInstruction.Burn=8]="Burn",TokenInstruction[TokenInstruction.CloseAccount=9]="CloseAccount",TokenInstruction[TokenInstruction.FreezeAccount=10]="FreezeAccount",TokenInstruction[TokenInstruction.ThawAccount=11]="ThawAccount",TokenInstruction[TokenInstruction.TransferChecked=12]="TransferChecked",TokenInstruction[TokenInstruction.ApproveChecked=13]="ApproveChecked",TokenInstruction[TokenInstruction.MintToChecked=14]="MintToChecked",TokenInstruction[TokenInstruction.BurnChecked=15]="BurnChecked",TokenInstruction[TokenInstruction.InitializeAccount2=16]="InitializeAccount2",TokenInstruction[TokenInstruction.SyncNative=17]="SyncNative",TokenInstruction[TokenInstruction.InitializeAccount3=18]="InitializeAccount3",TokenInstruction[TokenInstruction.InitializeMultisig2=19]="InitializeMultisig2",TokenInstruction[TokenInstruction.InitializeMint2=20]="InitializeMint2",TokenInstruction[TokenInstruction.GetAccountDataSize=21]="GetAccountDataSize",TokenInstruction[TokenInstruction.InitializeImmutableOwner=22]="InitializeImmutableOwner",TokenInstruction[TokenInstruction.AmountToUiAmount=23]="AmountToUiAmount",TokenInstruction[TokenInstruction.UiAmountToAmount=24]="UiAmountToAmount",TokenInstruction[TokenInstruction.InitializeMintCloseAuthority=25]="InitializeMintCloseAuthority",TokenInstruction[TokenInstruction.TransferFeeExtension=26]="TransferFeeExtension",TokenInstruction[TokenInstruction.ConfidentialTransferExtension=27]="ConfidentialTransferExtension",TokenInstruction[TokenInstruction.DefaultAccountStateExtension=28]="DefaultAccountStateExtension",TokenInstruction[TokenInstruction.Reallocate=29]="Reallocate",TokenInstruction[TokenInstruction.MemoTransferExtension=30]="MemoTransferExtension",TokenInstruction[TokenInstruction.CreateNativeMint=31]="CreateNativeMint",TokenInstruction[TokenInstruction.InitializeNonTransferableMint=32]="InitializeNonTransferableMint",TokenInstruction[TokenInstruction.InterestBearingMintExtension=33]="InterestBearingMintExtension",TokenInstruction[TokenInstruction.CpiGuardExtension=34]="CpiGuardExtension",TokenInstruction[TokenInstruction.InitializePermanentDelegate=35]="InitializePermanentDelegate",TokenInstruction[TokenInstruction.TransferHookExtension=36]="TransferHookExtension",TokenInstruction[TokenInstruction.MetadataPointerExtension=39]="MetadataPointerExtension",TokenInstruction[TokenInstruction.GroupPointerExtension=40]="GroupPointerExtension",TokenInstruction[TokenInstruction.GroupMemberPointerExtension=41]="GroupMemberPointerExtension",TokenInstruction[TokenInstruction.ScaledUiAmountExtension=43]="ScaledUiAmountExtension",TokenInstruction[TokenInstruction.PausableExtension=44]="PausableExtension"}(types_TokenInstruction||(types_TokenInstruction={}));var transfer_Buffer=__webpack_require__("./node_modules/buffer/index.js").Buffer;const transferInstructionData=(0,Layout.w3)([(0,Layout.u8)("instruction"),(0,esm._l)("amount")]);function createTransferInstruction(source,destination,owner,amount,multiSigners=[],programId=constants.x5){const keys=function addSigners(keys,ownerOrAuthority,multiSigners){if(multiSigners.length){keys.push({pubkey:ownerOrAuthority,isSigner:!1,isWritable:!1});for(const signer of multiSigners)keys.push({pubkey:signer instanceof index_browser_esm.PublicKey?signer:signer.publicKey,isSigner:!0,isWritable:!1})}else keys.push({pubkey:ownerOrAuthority,isSigner:!0,isWritable:!1});return keys}([{pubkey:source,isSigner:!1,isWritable:!0},{pubkey:destination,isSigner:!1,isWritable:!0}],owner,multiSigners),data=transfer_Buffer.alloc(transferInstructionData.span);return transferInstructionData.encode({instruction:types_TokenInstruction.Transfer,amount:BigInt(amount)},data),new index_browser_esm.fH({keys,programId,data})}const solana_transactionBuilder=async(network,token,walletPublicKey,recipientAddress)=>{const connection=new index_browser_esm.Connection(`${network.node_url}`,"confirmed"),recipientPublicKey=new index_browser_esm.PublicKey(recipientAddress||new Array(32).fill(0));if(token.contract){const sourceToken=new index_browser_esm.PublicKey(null==token?void 0:token.contract),transactionInstructions=[],associatedTokenFrom=await(0,mint.Ob)(sourceToken,walletPublicKey),fromAccount=await async function getAccount(connection,address,commitment,programId=constants.x5){return unpackAccount(address,await connection.getAccountInfo(address,commitment),programId)}(connection,associatedTokenFrom),associatedTokenTo=await(0,mint.Ob)(sourceToken,recipientPublicKey);await connection.getAccountInfo(associatedTokenTo)||transactionInstructions.push(function createAssociatedTokenAccountInstruction(payer,associatedToken,owner,mint,programId=constants.x5,associatedTokenProgramId=constants.EK){return buildAssociatedTokenAccountInstruction(payer,associatedToken,owner,mint,associatedTokenAccount_Buffer.alloc(0),programId,associatedTokenProgramId)}(walletPublicKey,associatedTokenTo,recipientPublicKey,sourceToken)),transactionInstructions.push(createTransferInstruction(fromAccount.address,associatedTokenTo,walletPublicKey,2e6*Math.pow(10,Number(null==token?void 0:token.decimals))));const result=await connection.getLatestBlockhash();return new index_browser_esm.ZX({feePayer:walletPublicKey,blockhash:result.blockhash,lastValidBlockHeight:result.lastValidBlockHeight}).add(...transactionInstructions)}{const transaction=new index_browser_esm.ZX,amountInLamports=2e4*Math.pow(10,Number(null==token?void 0:token.decimals)),transferInstruction=index_browser_esm.yq.transfer({fromPubkey:walletPublicKey,toPubkey:recipientPublicKey,lamports:amountInLamports});transaction.add(transferInstruction);const{blockhash}=await connection.getLatestBlockhash();return transaction.recentBlockhash=blockhash,transaction.feePayer=walletPublicKey,transaction}}},"./node_modules/@solana/buffer-layout-utils/lib/esm/index.mjs"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{lc:()=>bool,jE:()=>publicKey,_l:()=>u64});var Layout=__webpack_require__("./node_modules/@solana/buffer-layout/lib/Layout.js"),browser=__webpack_require__("./node_modules/bigint-buffer/dist/browser.js");const base_encodeDecode=layout=>({decode:layout.decode.bind(layout),encode:layout.encode.bind(layout)});var Buffer=__webpack_require__("./node_modules/buffer/index.js").Buffer;const bigInt=length=>property=>{const layout=(0,Layout.av)(length,property),{encode,decode}=base_encodeDecode(layout),bigIntLayout=layout;return bigIntLayout.decode=(buffer,offset)=>{const src=decode(buffer,offset);return(0,browser.k5)(Buffer.from(src))},bigIntLayout.encode=(bigInt,buffer,offset)=>{const src=(0,browser.Bq)(bigInt,length);return encode(src,buffer,offset)},bigIntLayout},bigIntBE=length=>property=>{const layout=(0,Layout.av)(length,property),{encode,decode}=base_encodeDecode(layout),bigIntLayout=layout;return bigIntLayout.decode=(buffer,offset)=>{const src=decode(buffer,offset);return(0,browser.cI)(Buffer.from(src))},bigIntLayout.encode=(bigInt,buffer,offset)=>{const src=(0,browser.zy)(bigInt,length);return encode(src,buffer,offset)},bigIntLayout},u64=bigInt(8);bigIntBE(8),bigInt(16),bigIntBE(16),bigInt(24),bigIntBE(24),bigInt(32),bigIntBE(32);new(__webpack_require__("./node_modules/bignumber.js/bignumber.mjs").A)("1e+18");const bool=property=>{const layout=(0,Layout.u8)(property),{encode,decode}=base_encodeDecode(layout),boolLayout=layout;return boolLayout.decode=(buffer,offset)=>!!decode(buffer,offset),boolLayout.encode=(bool,buffer,offset)=>{const src=Number(bool);return encode(src,buffer,offset)},boolLayout};var index_browser_esm=__webpack_require__("./node_modules/@solana/web3.js/lib/index.browser.esm.js");const publicKey=property=>{const layout=(0,Layout.av)(32,property),{encode,decode}=base_encodeDecode(layout),publicKeyLayout=layout;return publicKeyLayout.decode=(buffer,offset)=>{const src=decode(buffer,offset);return new index_browser_esm.PublicKey(src)},publicKeyLayout.encode=(publicKey,buffer,offset)=>{const src=publicKey.toBuffer();return encode(src,buffer,offset)},publicKeyLayout}},"./node_modules/@solana/spl-token/lib/esm/constants.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{EK:()=>ASSOCIATED_TOKEN_PROGRAM_ID,x5:()=>TOKEN_PROGRAM_ID});var _solana_web3_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@solana/web3.js/lib/index.browser.esm.js");const TOKEN_PROGRAM_ID=new _solana_web3_js__WEBPACK_IMPORTED_MODULE_0__.PublicKey("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),ASSOCIATED_TOKEN_PROGRAM_ID=(new _solana_web3_js__WEBPACK_IMPORTED_MODULE_0__.PublicKey("TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb"),new _solana_web3_js__WEBPACK_IMPORTED_MODULE_0__.PublicKey("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"));new _solana_web3_js__WEBPACK_IMPORTED_MODULE_0__.PublicKey("So11111111111111111111111111111111111111112"),new _solana_web3_js__WEBPACK_IMPORTED_MODULE_0__.PublicKey("9pan9bMn5HatX4EJdBwg9VgCa7Uz5HL8N1m5D3NdXejP")},"./node_modules/@solana/spl-token/lib/esm/errors.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{bY:()=>TokenInvalidAccountOwnerError,ce:()=>TokenInvalidAccountError,kD:()=>TokenAccountNotFoundError,lu:()=>TokenOwnerOffCurveError,vd:()=>TokenInvalidAccountSizeError});class TokenError extends Error{constructor(message){super(message)}}class TokenAccountNotFoundError extends TokenError{constructor(){super(...arguments),this.name="TokenAccountNotFoundError"}}class TokenInvalidAccountError extends TokenError{constructor(){super(...arguments),this.name="TokenInvalidAccountError"}}class TokenInvalidAccountOwnerError extends TokenError{constructor(){super(...arguments),this.name="TokenInvalidAccountOwnerError"}}class TokenInvalidAccountSizeError extends TokenError{constructor(){super(...arguments),this.name="TokenInvalidAccountSizeError"}}class TokenOwnerOffCurveError extends TokenError{constructor(){super(...arguments),this.name="TokenOwnerOffCurveError"}}},"./node_modules/@solana/spl-token/lib/esm/state/mint.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Ob:()=>getAssociatedTokenAddress});var _solana_buffer_layout__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@solana/buffer-layout/lib/Layout.js"),_solana_buffer_layout_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@solana/buffer-layout-utils/lib/esm/index.mjs"),_solana_web3_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@solana/web3.js/lib/index.browser.esm.js"),_constants_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@solana/spl-token/lib/esm/constants.js"),_errors_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@solana/spl-token/lib/esm/errors.js");__webpack_require__("./node_modules/buffer/index.js").Buffer;const MintLayout=(0,_solana_buffer_layout__WEBPACK_IMPORTED_MODULE_0__.w3)([(0,_solana_buffer_layout__WEBPACK_IMPORTED_MODULE_0__.DH)("mintAuthorityOption"),(0,_solana_buffer_layout_utils__WEBPACK_IMPORTED_MODULE_1__.jE)("mintAuthority"),(0,_solana_buffer_layout_utils__WEBPACK_IMPORTED_MODULE_1__._l)("supply"),(0,_solana_buffer_layout__WEBPACK_IMPORTED_MODULE_0__.u8)("decimals"),(0,_solana_buffer_layout_utils__WEBPACK_IMPORTED_MODULE_1__.lc)("isInitialized"),(0,_solana_buffer_layout__WEBPACK_IMPORTED_MODULE_0__.DH)("freezeAuthorityOption"),(0,_solana_buffer_layout_utils__WEBPACK_IMPORTED_MODULE_1__.jE)("freezeAuthority")]);MintLayout.span;async function getAssociatedTokenAddress(mint,owner,allowOwnerOffCurve=!1,programId=_constants_js__WEBPACK_IMPORTED_MODULE_3__.x5,associatedTokenProgramId=_constants_js__WEBPACK_IMPORTED_MODULE_3__.EK){if(!allowOwnerOffCurve&&!_solana_web3_js__WEBPACK_IMPORTED_MODULE_2__.PublicKey.isOnCurve(owner.toBuffer()))throw new _errors_js__WEBPACK_IMPORTED_MODULE_4__.lu;const[address]=await _solana_web3_js__WEBPACK_IMPORTED_MODULE_2__.PublicKey.findProgramAddress([owner.toBuffer(),programId.toBuffer(),mint.toBuffer()],associatedTokenProgramId);return address}},"./node_modules/bigint-buffer/dist/browser.js"(__unused_webpack_module,exports,__webpack_require__){var Buffer=__webpack_require__("./node_modules/buffer/index.js").Buffer;exports.k5=function toBigIntLE(buf){{const reversed=Buffer.from(buf);reversed.reverse();const hex=reversed.toString("hex");return 0===hex.length?BigInt(0):BigInt(`0x${hex}`)}},exports.cI=function toBigIntBE(buf){{const hex=buf.toString("hex");return 0===hex.length?BigInt(0):BigInt(`0x${hex}`)}},exports.Bq=function toBufferLE(num,width){{const hex=num.toString(16),buffer=Buffer.from(hex.padStart(2*width,"0").slice(0,2*width),"hex");return buffer.reverse(),buffer}},exports.zy=function toBufferBE(num,width){{const hex=num.toString(16);return Buffer.from(hex.padStart(2*width,"0").slice(0,2*width),"hex")}}}}]);